#include <gtest/gtest.h>

#include <cstdint>
#include <iostream>
#include <vector>

#include "core/utils/ma_anchors.h"

namespace ma {

TEST(UTILS, AnchorsGenerateAnchorStrides) {
    std::vector<ma_anchor_stride_t> expected = {
      { 8, 28, 784,   0},
      {16, 14, 196, 784},
      {32,  7,  49, 980},
    };
    std::vector<ma_anchor_stride_t> result = ma::utils::generateAnchorStrides(224, {8, 16, 32});

    EXPECT_EQ(result.size(), expected.size());
    for (size_t i = 0; i < result.size(); i++) {
        EXPECT_EQ(result[i].stride, expected[i].stride);
        EXPECT_EQ(result[i].split, expected[i].split);
        EXPECT_EQ(result[i].size, expected[i].size);
        EXPECT_EQ(result[i].start, expected[i].start);
    }
}

TEST(UTILS, AnchorsGenerateAnchorMatrix) {
    std::vector<std::vector<ma_pt2f_t>> expected = {
      {
       {0.5, 0.5},   {1.5, 0.5},   {2.5, 0.5},   {3.5, 0.5},   {4.5, 0.5},   {5.5, 0.5},   {6.5, 0.5},   {7.5, 0.5},
       {8.5, 0.5},   {9.5, 0.5},   {10.5, 0.5},  {11.5, 0.5},  {12.5, 0.5},  {13.5, 0.5},  {14.5, 0.5},  {15.5, 0.5},
       {16.5, 0.5},  {17.5, 0.5},  {18.5, 0.5},  {19.5, 0.5},  {20.5, 0.5},  {21.5, 0.5},  {22.5, 0.5},  {23.5, 0.5},
       {24.5, 0.5},  {25.5, 0.5},  {26.5, 0.5},  {27.5, 0.5},  {0.5, 1.5},   {1.5, 1.5},   {2.5, 1.5},   {3.5, 1.5},
       {4.5, 1.5},   {5.5, 1.5},   {6.5, 1.5},   {7.5, 1.5},   {8.5, 1.5},   {9.5, 1.5},   {10.5, 1.5},  {11.5, 1.5},
       {12.5, 1.5},  {13.5, 1.5},  {14.5, 1.5},  {15.5, 1.5},  {16.5, 1.5},  {17.5, 1.5},  {18.5, 1.5},  {19.5, 1.5},
       {20.5, 1.5},  {21.5, 1.5},  {22.5, 1.5},  {23.5, 1.5},  {24.5, 1.5},  {25.5, 1.5},  {26.5, 1.5},  {27.5, 1.5},
       {0.5, 2.5},   {1.5, 2.5},   {2.5, 2.5},   {3.5, 2.5},   {4.5, 2.5},   {5.5, 2.5},   {6.5, 2.5},   {7.5, 2.5},
       {8.5, 2.5},   {9.5, 2.5},   {10.5, 2.5},  {11.5, 2.5},  {12.5, 2.5},  {13.5, 2.5},  {14.5, 2.5},  {15.5, 2.5},
       {16.5, 2.5},  {17.5, 2.5},  {18.5, 2.5},  {19.5, 2.5},  {20.5, 2.5},  {21.5, 2.5},  {22.5, 2.5},  {23.5, 2.5},
       {24.5, 2.5},  {25.5, 2.5},  {26.5, 2.5},  {27.5, 2.5},  {0.5, 3.5},   {1.5, 3.5},   {2.5, 3.5},   {3.5, 3.5},
       {4.5, 3.5},   {5.5, 3.5},   {6.5, 3.5},   {7.5, 3.5},   {8.5, 3.5},   {9.5, 3.5},   {10.5, 3.5},  {11.5, 3.5},
       {12.5, 3.5},  {13.5, 3.5},  {14.5, 3.5},  {15.5, 3.5},  {16.5, 3.5},  {17.5, 3.5},  {18.5, 3.5},  {19.5, 3.5},
       {20.5, 3.5},  {21.5, 3.5},  {22.5, 3.5},  {23.5, 3.5},  {24.5, 3.5},  {25.5, 3.5},  {26.5, 3.5},  {27.5, 3.5},
       {0.5, 4.5},   {1.5, 4.5},   {2.5, 4.5},   {3.5, 4.5},   {4.5, 4.5},   {5.5, 4.5},   {6.5, 4.5},   {7.5, 4.5},
       {8.5, 4.5},   {9.5, 4.5},   {10.5, 4.5},  {11.5, 4.5},  {12.5, 4.5},  {13.5, 4.5},  {14.5, 4.5},  {15.5, 4.5},
       {16.5, 4.5},  {17.5, 4.5},  {18.5, 4.5},  {19.5, 4.5},  {20.5, 4.5},  {21.5, 4.5},  {22.5, 4.5},  {23.5, 4.5},
       {24.5, 4.5},  {25.5, 4.5},  {26.5, 4.5},  {27.5, 4.5},  {0.5, 5.5},   {1.5, 5.5},   {2.5, 5.5},   {3.5, 5.5},
       {4.5, 5.5},   {5.5, 5.5},   {6.5, 5.5},   {7.5, 5.5},   {8.5, 5.5},   {9.5, 5.5},   {10.5, 5.5},  {11.5, 5.5},
       {12.5, 5.5},  {13.5, 5.5},  {14.5, 5.5},  {15.5, 5.5},  {16.5, 5.5},  {17.5, 5.5},  {18.5, 5.5},  {19.5, 5.5},
       {20.5, 5.5},  {21.5, 5.5},  {22.5, 5.5},  {23.5, 5.5},  {24.5, 5.5},  {25.5, 5.5},  {26.5, 5.5},  {27.5, 5.5},
       {0.5, 6.5},   {1.5, 6.5},   {2.5, 6.5},   {3.5, 6.5},   {4.5, 6.5},   {5.5, 6.5},   {6.5, 6.5},   {7.5, 6.5},
       {8.5, 6.5},   {9.5, 6.5},   {10.5, 6.5},  {11.5, 6.5},  {12.5, 6.5},  {13.5, 6.5},  {14.5, 6.5},  {15.5, 6.5},
       {16.5, 6.5},  {17.5, 6.5},  {18.5, 6.5},  {19.5, 6.5},  {20.5, 6.5},  {21.5, 6.5},  {22.5, 6.5},  {23.5, 6.5},
       {24.5, 6.5},  {25.5, 6.5},  {26.5, 6.5},  {27.5, 6.5},  {0.5, 7.5},   {1.5, 7.5},   {2.5, 7.5},   {3.5, 7.5},
       {4.5, 7.5},   {5.5, 7.5},   {6.5, 7.5},   {7.5, 7.5},   {8.5, 7.5},   {9.5, 7.5},   {10.5, 7.5},  {11.5, 7.5},
       {12.5, 7.5},  {13.5, 7.5},  {14.5, 7.5},  {15.5, 7.5},  {16.5, 7.5},  {17.5, 7.5},  {18.5, 7.5},  {19.5, 7.5},
       {20.5, 7.5},  {21.5, 7.5},  {22.5, 7.5},  {23.5, 7.5},  {24.5, 7.5},  {25.5, 7.5},  {26.5, 7.5},  {27.5, 7.5},
       {0.5, 8.5},   {1.5, 8.5},   {2.5, 8.5},   {3.5, 8.5},   {4.5, 8.5},   {5.5, 8.5},   {6.5, 8.5},   {7.5, 8.5},
       {8.5, 8.5},   {9.5, 8.5},   {10.5, 8.5},  {11.5, 8.5},  {12.5, 8.5},  {13.5, 8.5},  {14.5, 8.5},  {15.5, 8.5},
       {16.5, 8.5},  {17.5, 8.5},  {18.5, 8.5},  {19.5, 8.5},  {20.5, 8.5},  {21.5, 8.5},  {22.5, 8.5},  {23.5, 8.5},
       {24.5, 8.5},  {25.5, 8.5},  {26.5, 8.5},  {27.5, 8.5},  {0.5, 9.5},   {1.5, 9.5},   {2.5, 9.5},   {3.5, 9.5},
       {4.5, 9.5},   {5.5, 9.5},   {6.5, 9.5},   {7.5, 9.5},   {8.5, 9.5},   {9.5, 9.5},   {10.5, 9.5},  {11.5, 9.5},
       {12.5, 9.5},  {13.5, 9.5},  {14.5, 9.5},  {15.5, 9.5},  {16.5, 9.5},  {17.5, 9.5},  {18.5, 9.5},  {19.5, 9.5},
       {20.5, 9.5},  {21.5, 9.5},  {22.5, 9.5},  {23.5, 9.5},  {24.5, 9.5},  {25.5, 9.5},  {26.5, 9.5},  {27.5, 9.5},
       {0.5, 10.5},  {1.5, 10.5},  {2.5, 10.5},  {3.5, 10.5},  {4.5, 10.5},  {5.5, 10.5},  {6.5, 10.5},  {7.5, 10.5},
       {8.5, 10.5},  {9.5, 10.5},  {10.5, 10.5}, {11.5, 10.5}, {12.5, 10.5}, {13.5, 10.5}, {14.5, 10.5}, {15.5, 10.5},
       {16.5, 10.5}, {17.5, 10.5}, {18.5, 10.5}, {19.5, 10.5}, {20.5, 10.5}, {21.5, 10.5}, {22.5, 10.5}, {23.5, 10.5},
       {24.5, 10.5}, {25.5, 10.5}, {26.5, 10.5}, {27.5, 10.5}, {0.5, 11.5},  {1.5, 11.5},  {2.5, 11.5},  {3.5, 11.5},
       {4.5, 11.5},  {5.5, 11.5},  {6.5, 11.5},  {7.5, 11.5},  {8.5, 11.5},  {9.5, 11.5},  {10.5, 11.5}, {11.5, 11.5},
       {12.5, 11.5}, {13.5, 11.5}, {14.5, 11.5}, {15.5, 11.5}, {16.5, 11.5}, {17.5, 11.5}, {18.5, 11.5}, {19.5, 11.5},
       {20.5, 11.5}, {21.5, 11.5}, {22.5, 11.5}, {23.5, 11.5}, {24.5, 11.5}, {25.5, 11.5}, {26.5, 11.5}, {27.5, 11.5},
       {0.5, 12.5},  {1.5, 12.5},  {2.5, 12.5},  {3.5, 12.5},  {4.5, 12.5},  {5.5, 12.5},  {6.5, 12.5},  {7.5, 12.5},
       {8.5, 12.5},  {9.5, 12.5},  {10.5, 12.5}, {11.5, 12.5}, {12.5, 12.5}, {13.5, 12.5}, {14.5, 12.5}, {15.5, 12.5},
       {16.5, 12.5}, {17.5, 12.5}, {18.5, 12.5}, {19.5, 12.5}, {20.5, 12.5}, {21.5, 12.5}, {22.5, 12.5}, {23.5, 12.5},
       {24.5, 12.5}, {25.5, 12.5}, {26.5, 12.5}, {27.5, 12.5}, {0.5, 13.5},  {1.5, 13.5},  {2.5, 13.5},  {3.5, 13.5},
       {4.5, 13.5},  {5.5, 13.5},  {6.5, 13.5},  {7.5, 13.5},  {8.5, 13.5},  {9.5, 13.5},  {10.5, 13.5}, {11.5, 13.5},
       {12.5, 13.5}, {13.5, 13.5}, {14.5, 13.5}, {15.5, 13.5}, {16.5, 13.5}, {17.5, 13.5}, {18.5, 13.5}, {19.5, 13.5},
       {20.5, 13.5}, {21.5, 13.5}, {22.5, 13.5}, {23.5, 13.5}, {24.5, 13.5}, {25.5, 13.5}, {26.5, 13.5}, {27.5, 13.5},
       {0.5, 14.5},  {1.5, 14.5},  {2.5, 14.5},  {3.5, 14.5},  {4.5, 14.5},  {5.5, 14.5},  {6.5, 14.5},  {7.5, 14.5},
       {8.5, 14.5},  {9.5, 14.5},  {10.5, 14.5}, {11.5, 14.5}, {12.5, 14.5}, {13.5, 14.5}, {14.5, 14.5}, {15.5, 14.5},
       {16.5, 14.5}, {17.5, 14.5}, {18.5, 14.5}, {19.5, 14.5}, {20.5, 14.5}, {21.5, 14.5}, {22.5, 14.5}, {23.5, 14.5},
       {24.5, 14.5}, {25.5, 14.5}, {26.5, 14.5}, {27.5, 14.5}, {0.5, 15.5},  {1.5, 15.5},  {2.5, 15.5},  {3.5, 15.5},
       {4.5, 15.5},  {5.5, 15.5},  {6.5, 15.5},  {7.5, 15.5},  {8.5, 15.5},  {9.5, 15.5},  {10.5, 15.5}, {11.5, 15.5},
       {12.5, 15.5}, {13.5, 15.5}, {14.5, 15.5}, {15.5, 15.5}, {16.5, 15.5}, {17.5, 15.5}, {18.5, 15.5}, {19.5, 15.5},
       {20.5, 15.5}, {21.5, 15.5}, {22.5, 15.5}, {23.5, 15.5}, {24.5, 15.5}, {25.5, 15.5}, {26.5, 15.5}, {27.5, 15.5},
       {0.5, 16.5},  {1.5, 16.5},  {2.5, 16.5},  {3.5, 16.5},  {4.5, 16.5},  {5.5, 16.5},  {6.5, 16.5},  {7.5, 16.5},
       {8.5, 16.5},  {9.5, 16.5},  {10.5, 16.5}, {11.5, 16.5}, {12.5, 16.5}, {13.5, 16.5}, {14.5, 16.5}, {15.5, 16.5},
       {16.5, 16.5}, {17.5, 16.5}, {18.5, 16.5}, {19.5, 16.5}, {20.5, 16.5}, {21.5, 16.5}, {22.5, 16.5}, {23.5, 16.5},
       {24.5, 16.5}, {25.5, 16.5}, {26.5, 16.5}, {27.5, 16.5}, {0.5, 17.5},  {1.5, 17.5},  {2.5, 17.5},  {3.5, 17.5},
       {4.5, 17.5},  {5.5, 17.5},  {6.5, 17.5},  {7.5, 17.5},  {8.5, 17.5},  {9.5, 17.5},  {10.5, 17.5}, {11.5, 17.5},
       {12.5, 17.5}, {13.5, 17.5}, {14.5, 17.5}, {15.5, 17.5}, {16.5, 17.5}, {17.5, 17.5}, {18.5, 17.5}, {19.5, 17.5},
       {20.5, 17.5}, {21.5, 17.5}, {22.5, 17.5}, {23.5, 17.5}, {24.5, 17.5}, {25.5, 17.5}, {26.5, 17.5}, {27.5, 17.5},
       {0.5, 18.5},  {1.5, 18.5},  {2.5, 18.5},  {3.5, 18.5},  {4.5, 18.5},  {5.5, 18.5},  {6.5, 18.5},  {7.5, 18.5},
       {8.5, 18.5},  {9.5, 18.5},  {10.5, 18.5}, {11.5, 18.5}, {12.5, 18.5}, {13.5, 18.5}, {14.5, 18.5}, {15.5, 18.5},
       {16.5, 18.5}, {17.5, 18.5}, {18.5, 18.5}, {19.5, 18.5}, {20.5, 18.5}, {21.5, 18.5}, {22.5, 18.5}, {23.5, 18.5},
       {24.5, 18.5}, {25.5, 18.5}, {26.5, 18.5}, {27.5, 18.5}, {0.5, 19.5},  {1.5, 19.5},  {2.5, 19.5},  {3.5, 19.5},
       {4.5, 19.5},  {5.5, 19.5},  {6.5, 19.5},  {7.5, 19.5},  {8.5, 19.5},  {9.5, 19.5},  {10.5, 19.5}, {11.5, 19.5},
       {12.5, 19.5}, {13.5, 19.5}, {14.5, 19.5}, {15.5, 19.5}, {16.5, 19.5}, {17.5, 19.5}, {18.5, 19.5}, {19.5, 19.5},
       {20.5, 19.5}, {21.5, 19.5}, {22.5, 19.5}, {23.5, 19.5}, {24.5, 19.5}, {25.5, 19.5}, {26.5, 19.5}, {27.5, 19.5},
       {0.5, 20.5},  {1.5, 20.5},  {2.5, 20.5},  {3.5, 20.5},  {4.5, 20.5},  {5.5, 20.5},  {6.5, 20.5},  {7.5, 20.5},
       {8.5, 20.5},  {9.5, 20.5},  {10.5, 20.5}, {11.5, 20.5}, {12.5, 20.5}, {13.5, 20.5}, {14.5, 20.5}, {15.5, 20.5},
       {16.5, 20.5}, {17.5, 20.5}, {18.5, 20.5}, {19.5, 20.5}, {20.5, 20.5}, {21.5, 20.5}, {22.5, 20.5}, {23.5, 20.5},
       {24.5, 20.5}, {25.5, 20.5}, {26.5, 20.5}, {27.5, 20.5}, {0.5, 21.5},  {1.5, 21.5},  {2.5, 21.5},  {3.5, 21.5},
       {4.5, 21.5},  {5.5, 21.5},  {6.5, 21.5},  {7.5, 21.5},  {8.5, 21.5},  {9.5, 21.5},  {10.5, 21.5}, {11.5, 21.5},
       {12.5, 21.5}, {13.5, 21.5}, {14.5, 21.5}, {15.5, 21.5}, {16.5, 21.5}, {17.5, 21.5}, {18.5, 21.5}, {19.5, 21.5},
       {20.5, 21.5}, {21.5, 21.5}, {22.5, 21.5}, {23.5, 21.5}, {24.5, 21.5}, {25.5, 21.5}, {26.5, 21.5}, {27.5, 21.5},
       {0.5, 22.5},  {1.5, 22.5},  {2.5, 22.5},  {3.5, 22.5},  {4.5, 22.5},  {5.5, 22.5},  {6.5, 22.5},  {7.5, 22.5},
       {8.5, 22.5},  {9.5, 22.5},  {10.5, 22.5}, {11.5, 22.5}, {12.5, 22.5}, {13.5, 22.5}, {14.5, 22.5}, {15.5, 22.5},
       {16.5, 22.5}, {17.5, 22.5}, {18.5, 22.5}, {19.5, 22.5}, {20.5, 22.5}, {21.5, 22.5}, {22.5, 22.5}, {23.5, 22.5},
       {24.5, 22.5}, {25.5, 22.5}, {26.5, 22.5}, {27.5, 22.5}, {0.5, 23.5},  {1.5, 23.5},  {2.5, 23.5},  {3.5, 23.5},
       {4.5, 23.5},  {5.5, 23.5},  {6.5, 23.5},  {7.5, 23.5},  {8.5, 23.5},  {9.5, 23.5},  {10.5, 23.5}, {11.5, 23.5},
       {12.5, 23.5}, {13.5, 23.5}, {14.5, 23.5}, {15.5, 23.5}, {16.5, 23.5}, {17.5, 23.5}, {18.5, 23.5}, {19.5, 23.5},
       {20.5, 23.5}, {21.5, 23.5}, {22.5, 23.5}, {23.5, 23.5}, {24.5, 23.5}, {25.5, 23.5}, {26.5, 23.5}, {27.5, 23.5},
       {0.5, 24.5},  {1.5, 24.5},  {2.5, 24.5},  {3.5, 24.5},  {4.5, 24.5},  {5.5, 24.5},  {6.5, 24.5},  {7.5, 24.5},
       {8.5, 24.5},  {9.5, 24.5},  {10.5, 24.5}, {11.5, 24.5}, {12.5, 24.5}, {13.5, 24.5}, {14.5, 24.5}, {15.5, 24.5},
       {16.5, 24.5}, {17.5, 24.5}, {18.5, 24.5}, {19.5, 24.5}, {20.5, 24.5}, {21.5, 24.5}, {22.5, 24.5}, {23.5, 24.5},
       {24.5, 24.5}, {25.5, 24.5}, {26.5, 24.5}, {27.5, 24.5}, {0.5, 25.5},  {1.5, 25.5},  {2.5, 25.5},  {3.5, 25.5},
       {4.5, 25.5},  {5.5, 25.5},  {6.5, 25.5},  {7.5, 25.5},  {8.5, 25.5},  {9.5, 25.5},  {10.5, 25.5}, {11.5, 25.5},
       {12.5, 25.5}, {13.5, 25.5}, {14.5, 25.5}, {15.5, 25.5}, {16.5, 25.5}, {17.5, 25.5}, {18.5, 25.5}, {19.5, 25.5},
       {20.5, 25.5}, {21.5, 25.5}, {22.5, 25.5}, {23.5, 25.5}, {24.5, 25.5}, {25.5, 25.5}, {26.5, 25.5}, {27.5, 25.5},
       {0.5, 26.5},  {1.5, 26.5},  {2.5, 26.5},  {3.5, 26.5},  {4.5, 26.5},  {5.5, 26.5},  {6.5, 26.5},  {7.5, 26.5},
       {8.5, 26.5},  {9.5, 26.5},  {10.5, 26.5}, {11.5, 26.5}, {12.5, 26.5}, {13.5, 26.5}, {14.5, 26.5}, {15.5, 26.5},
       {16.5, 26.5}, {17.5, 26.5}, {18.5, 26.5}, {19.5, 26.5}, {20.5, 26.5}, {21.5, 26.5}, {22.5, 26.5}, {23.5, 26.5},
       {24.5, 26.5}, {25.5, 26.5}, {26.5, 26.5}, {27.5, 26.5}, {0.5, 27.5},  {1.5, 27.5},  {2.5, 27.5},  {3.5, 27.5},
       {4.5, 27.5},  {5.5, 27.5},  {6.5, 27.5},  {7.5, 27.5},  {8.5, 27.5},  {9.5, 27.5},  {10.5, 27.5}, {11.5, 27.5},
       {12.5, 27.5}, {13.5, 27.5}, {14.5, 27.5}, {15.5, 27.5}, {16.5, 27.5}, {17.5, 27.5}, {18.5, 27.5}, {19.5, 27.5},
       {20.5, 27.5}, {21.5, 27.5}, {22.5, 27.5}, {23.5, 27.5}, {24.5, 27.5}, {25.5, 27.5}, {26.5, 27.5}, {27.5, 27.5},
       },
      {
       {0.5, 0.5},   {1.5, 0.5},   {2.5, 0.5},   {3.5, 0.5},   {4.5, 0.5},   {5.5, 0.5},   {6.5, 0.5},   {7.5, 0.5},
       {8.5, 0.5},   {9.5, 0.5},   {10.5, 0.5},  {11.5, 0.5},  {12.5, 0.5},  {13.5, 0.5},  {0.5, 1.5},   {1.5, 1.5},
       {2.5, 1.5},   {3.5, 1.5},   {4.5, 1.5},   {5.5, 1.5},   {6.5, 1.5},   {7.5, 1.5},   {8.5, 1.5},   {9.5, 1.5},
       {10.5, 1.5},  {11.5, 1.5},  {12.5, 1.5},  {13.5, 1.5},  {0.5, 2.5},   {1.5, 2.5},   {2.5, 2.5},   {3.5, 2.5},
       {4.5, 2.5},   {5.5, 2.5},   {6.5, 2.5},   {7.5, 2.5},   {8.5, 2.5},   {9.5, 2.5},   {10.5, 2.5},  {11.5, 2.5},
       {12.5, 2.5},  {13.5, 2.5},  {0.5, 3.5},   {1.5, 3.5},   {2.5, 3.5},   {3.5, 3.5},   {4.5, 3.5},   {5.5, 3.5},
       {6.5, 3.5},   {7.5, 3.5},   {8.5, 3.5},   {9.5, 3.5},   {10.5, 3.5},  {11.5, 3.5},  {12.5, 3.5},  {13.5, 3.5},
       {0.5, 4.5},   {1.5, 4.5},   {2.5, 4.5},   {3.5, 4.5},   {4.5, 4.5},   {5.5, 4.5},   {6.5, 4.5},   {7.5, 4.5},
       {8.5, 4.5},   {9.5, 4.5},   {10.5, 4.5},  {11.5, 4.5},  {12.5, 4.5},  {13.5, 4.5},  {0.5, 5.5},   {1.5, 5.5},
       {2.5, 5.5},   {3.5, 5.5},   {4.5, 5.5},   {5.5, 5.5},   {6.5, 5.5},   {7.5, 5.5},   {8.5, 5.5},   {9.5, 5.5},
       {10.5, 5.5},  {11.5, 5.5},  {12.5, 5.5},  {13.5, 5.5},  {0.5, 6.5},   {1.5, 6.5},   {2.5, 6.5},   {3.5, 6.5},
       {4.5, 6.5},   {5.5, 6.5},   {6.5, 6.5},   {7.5, 6.5},   {8.5, 6.5},   {9.5, 6.5},   {10.5, 6.5},  {11.5, 6.5},
       {12.5, 6.5},  {13.5, 6.5},  {0.5, 7.5},   {1.5, 7.5},   {2.5, 7.5},   {3.5, 7.5},   {4.5, 7.5},   {5.5, 7.5},
       {6.5, 7.5},   {7.5, 7.5},   {8.5, 7.5},   {9.5, 7.5},   {10.5, 7.5},  {11.5, 7.5},  {12.5, 7.5},  {13.5, 7.5},
       {0.5, 8.5},   {1.5, 8.5},   {2.5, 8.5},   {3.5, 8.5},   {4.5, 8.5},   {5.5, 8.5},   {6.5, 8.5},   {7.5, 8.5},
       {8.5, 8.5},   {9.5, 8.5},   {10.5, 8.5},  {11.5, 8.5},  {12.5, 8.5},  {13.5, 8.5},  {0.5, 9.5},   {1.5, 9.5},
       {2.5, 9.5},   {3.5, 9.5},   {4.5, 9.5},   {5.5, 9.5},   {6.5, 9.5},   {7.5, 9.5},   {8.5, 9.5},   {9.5, 9.5},
       {10.5, 9.5},  {11.5, 9.5},  {12.5, 9.5},  {13.5, 9.5},  {0.5, 10.5},  {1.5, 10.5},  {2.5, 10.5},  {3.5, 10.5},
       {4.5, 10.5},  {5.5, 10.5},  {6.5, 10.5},  {7.5, 10.5},  {8.5, 10.5},  {9.5, 10.5},  {10.5, 10.5}, {11.5, 10.5},
       {12.5, 10.5}, {13.5, 10.5}, {0.5, 11.5},  {1.5, 11.5},  {2.5, 11.5},  {3.5, 11.5},  {4.5, 11.5},  {5.5, 11.5},
       {6.5, 11.5},  {7.5, 11.5},  {8.5, 11.5},  {9.5, 11.5},  {10.5, 11.5}, {11.5, 11.5}, {12.5, 11.5}, {13.5, 11.5},
       {0.5, 12.5},  {1.5, 12.5},  {2.5, 12.5},  {3.5, 12.5},  {4.5, 12.5},  {5.5, 12.5},  {6.5, 12.5},  {7.5, 12.5},
       {8.5, 12.5},  {9.5, 12.5},  {10.5, 12.5}, {11.5, 12.5}, {12.5, 12.5}, {13.5, 12.5}, {0.5, 13.5},  {1.5, 13.5},
       {2.5, 13.5},  {3.5, 13.5},  {4.5, 13.5},  {5.5, 13.5},  {6.5, 13.5},  {7.5, 13.5},  {8.5, 13.5},  {9.5, 13.5},
       {10.5, 13.5}, {11.5, 13.5}, {12.5, 13.5}, {13.5, 13.5},
       },
      {
       {0.5, 0.5}, {1.5, 0.5}, {2.5, 0.5}, {3.5, 0.5}, {4.5, 0.5}, {5.5, 0.5}, {6.5, 0.5}, {0.5, 1.5}, {1.5, 1.5},
       {2.5, 1.5}, {3.5, 1.5}, {4.5, 1.5}, {5.5, 1.5}, {6.5, 1.5}, {0.5, 2.5}, {1.5, 2.5}, {2.5, 2.5}, {3.5, 2.5},
       {4.5, 2.5}, {5.5, 2.5}, {6.5, 2.5}, {0.5, 3.5}, {1.5, 3.5}, {2.5, 3.5}, {3.5, 3.5}, {4.5, 3.5}, {5.5, 3.5},
       {6.5, 3.5}, {0.5, 4.5}, {1.5, 4.5}, {2.5, 4.5}, {3.5, 4.5}, {4.5, 4.5}, {5.5, 4.5}, {6.5, 4.5}, {0.5, 5.5},
       {1.5, 5.5}, {2.5, 5.5}, {3.5, 5.5}, {4.5, 5.5}, {5.5, 5.5}, {6.5, 5.5}, {0.5, 6.5}, {1.5, 6.5}, {2.5, 6.5},
       {3.5, 6.5}, {4.5, 6.5}, {5.5, 6.5}, {6.5, 6.5},
       },
    };

    const std::vector<ma_anchor_stride_t> anchor_strides = ma::utils::generateAnchorStrides(224, {8, 16, 32});
    std::vector<std::vector<ma_pt2f_t>>   result         = ma::utils::generateAnchorMatrix(anchor_strides, 1.f, 1.f);

    EXPECT_EQ(result.size(), expected.size());
    for (size_t i = 0; i < result.size(); i++) {
        EXPECT_EQ(result[i].size(), expected[i].size());
        for (size_t j = 0; j < result[i].size(); j++) {
            EXPECT_FLOAT_EQ(result[i][j].x, expected[i][j].x);
            EXPECT_FLOAT_EQ(result[i][j].y, expected[i][j].y);
        }
    }
}

}  // namespace ma